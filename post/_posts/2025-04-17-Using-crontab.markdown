---
layout: post
title:  "ë¦¬ëˆ…ìŠ¤ì—ì„œ `crontab`ìœ¼ë¡œ ë°˜ë³µ ì‘ì—… ìë™í™”í•˜ê¸° "
date:   2025-04-17 12:16:09 +0900
categories: [engineering]
description: >
  ì£¼ê¸°ì ì¸ ë°ì´í„° ì²˜ë¦¬ ì‘ì—…ì„ ìë™í™”í•˜ëŠ” ë°©ë²•
image: 
  path: https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR66FyYBvwDfT5R8UQNCqk4o1i4wvMQzj50NCphTLlGD3FL7WbSKORgDdJ_6002YpvCP-E&usqp=CAU
author: LearningnRunning
keywords: crontab
seo:
  date_modified: 2025-04-17
  type: BlogPosting
sitemap:
  changefreq: monthly
  priority: 0.8


---

# ë¦¬ëˆ…ìŠ¤ì—ì„œ `crontab`ìœ¼ë¡œ ë°˜ë³µ ì‘ì—… ìë™í™”í•˜ê¸°  

**í¬ë¡¤ë§ ë°ì´í„° DB ì—…ë°ì´íŠ¸ ìë™í™” ì‚¬ë¡€ë¡œ ë°°ìš°ëŠ” ì‹¤ì „ í™œìš©ë²•**

ì•ˆë…•í•˜ì„¸ìš”. ì´ ê¸€ì—ì„œëŠ” ë¦¬ëˆ…ìŠ¤ì˜ `crontab`ì„ í™œìš©í•˜ì—¬ **ì£¼ê¸°ì ì¸ ë°ì´í„° ì²˜ë¦¬ ì‘ì—…ì„ ìë™í™”í•˜ëŠ” ë°©ë²•**ì„ ì†Œê°œë“œë¦½ë‹ˆë‹¤.  

ë§¤ì‹œê°„ë§ˆë‹¤ ì¶•ì ë˜ëŠ” í¬ë¡¤ë§ ë°ì´í„°ë¥¼ ë§¤ì¼ 5ì‹œì— ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ê³  parquet ë°±ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…ì„ `crontab`ìœ¼ë¡œ ì§„í–‰ í–ˆìŠµë‹ˆë‹¤.

---

## âœ… `crontab`ì´ë€?

`crontab`ì€ ë¦¬ëˆ…ìŠ¤ ë° ìœ ë‹‰ìŠ¤ ê³„ì—´ ìš´ì˜ì²´ì œì—ì„œ **ì •í•´ì§„ ì‹œê°„ë§ˆë‹¤ ìë™ìœ¼ë¡œ ëª…ë ¹ì–´ë‚˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰**í•  ìˆ˜ ìˆë„ë¡ ì˜ˆì•½í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. ëŒ€í‘œì ì¸ í™œìš© ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

- ì£¼ê¸°ì ì¸ ë°ì´í„° ìˆ˜ì§‘ ë° ì²˜ë¦¬
- ë¡œê·¸ ì •ë¦¬ ë° ë°±ì—…
- ìë™ ë©”ì¼ ë°œì†¡

---

## ğŸ–¥ï¸ ì‚¬ìš© ê°€ëŠ¥í•œ ìš´ì˜ì²´ì œ

| ìš´ì˜ì²´ì œ | ì§€ì› ì—¬ë¶€ |
|----------|:-----------:|
| Ubuntu (ì˜ˆ: 20.04, 22.04) | âœ… |
| Debian ê³„ì—´              | âœ… |
| CentOS, RHEL ê³„ì—´        | âœ… |
| macOS (launchdë¡œ ëŒ€ì²´ ê°€ëŠ¥) | âœ… |
| Windows                  | âŒ (WSLì´ë‚˜ ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬ë¡œ ëŒ€ì²´ ê°€ëŠ¥) |

---

## â° ì‹œê°„ ì„¤ì • í˜•ì‹ê³¼ ì˜ˆì‹œ

í¬ë¡ íƒ­ì€ ë‹¤ìŒê³¼ ê°™ì€ 5ê°œì˜ í•„ë“œë¡œ ì‹œê°„ ì¡°ê±´ì„ ì§€ì •í•©ë‹ˆë‹¤.

```
ë¶„(0â€“59) ì‹œ(0â€“23) ì¼(1â€“31) ì›”(1â€“12) ìš”ì¼(0â€“7, 0 ë˜ëŠ” 7ì€ ì¼ìš”ì¼) ì‹¤í–‰í• ëª…ë ¹ì–´
```

### ğŸ¯ ì£¼ìš” ì˜ˆì‹œ

| ì„¤ëª… | í¬ë¡ íƒ­ í‘œí˜„ | ì˜ˆì‹œ |
|------|-------------|------|
| íŠ¹ì • ì‹œê°„ì— ì‹¤í–‰ | `30 8 * * 1` | ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 8ì‹œ 30ë¶„ |
| ë°˜ë³µ ì‹¤í–‰ (ë§¤ì‹œ 0, 20, 40ë¶„) | `0,20,40 * * * *` | ë§¤ì‹œê°„ 0ë¶„, 20ë¶„, 40ë¶„ |
| ë²”ìœ„ + ë°˜ë³µ ì‹¤í–‰ | `0,20,40 8-22 * * *` | ë§¤ì¼ ì˜¤ì „ 8ì‹œ~ì˜¤í›„ 10ì‹œ ì‚¬ì´ 0,20,40ë¶„ |
| ê°„ê²© ì‹¤í–‰ (30ë¶„ë§ˆë‹¤) | `*/30 * * * *` | ë§¤ 30ë¶„ë§ˆë‹¤ |

---

## ğŸ“ crontab ë“±ë¡ ë°©ë²•

### 1. í¬ë¡ íƒ­ í¸ì§‘

```bash
crontab -e
```

### 2. ì‹œê°„ ë° ì‹¤í–‰í•  ëª…ë ¹ì–´ ì¶”ê°€

- ë§¤ì¼ ì˜¤ì „ 5ì‹œì— run_daily_update.shë¥¼ ì‹¤í–‰

```bash
0 5 * * * . /home/your_user/project/run_daily_update.sh
```

### 3. ë“±ë¡ëœ í¬ë¡ íƒ­ í™•ì¸

```bash
crontab -l
```

---


## ğŸ“¦ ìë™í™” ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ì˜ˆì‹œ

ë‹¤ìŒì€ ë°ì´í„° ë¡œë”© ë° ë°±ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.

**`/home/your_user/project/run_daily_update.sh`**

```bash
#!/bin/bash

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
export HOME=/home/your_user
export PATH="/home/your_user/.pyenv/versions/your_env_name/bin:/usr/bin:/bin"

# í˜„ì¬ ì‹œê°„ ê¸°ì¤€ ë¡œê·¸ íŒŒì¼ëª… ì„¤ì •
NOW=$(date +"%Y%m%d_%H%M%S")
LOG_FILE="/home/your_user/project/logs/update_${NOW}.log"

echo "===== ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘: $(date) =====" | tee -a "$LOG_FILE"

cd /home/your_user/project
source /home/your_user/.pyenv/versions/your_env_name/bin/activate

# Python ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë° ë¡œê·¸ ì €ì¥
{
    python -u load_data.py
} 2>&1 | tee -a "$LOG_FILE"

echo "===== ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ: $(date) =====" | tee -a "$LOG_FILE"

# 30ì¼ ì´ìƒëœ ë¡œê·¸ íŒŒì¼ ì‚­ì œ
find /home/your_user/project/logs -type f -name "update_*.log" -mtime +30 -delete
```

---

## ğŸ“˜ ë¡œê¹… ë°©ë²•

### teeë¥¼ ì´ìš©í•œ ë°©ë²•
- ë¡œê·¸ëŠ” `tee` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ í‘œì¤€ ì¶œë ¥ê³¼ ë™ì‹œì— ë¡œê·¸ íŒŒì¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.
- ë¡œê·¸ íŒŒì¼ì€ `/home/your_user/project/logs/update_YYYYMMDD_HHMMSS.log` í˜•íƒœë¡œ ì €ì¥ë©ë‹ˆë‹¤.

### crontabì—ì„œ ì§ì ‘ ë¡œê·¸ ì„¤ì •
- crontab ëª…ë ¹ì–´ ì¤„ ì•ˆì— ë¦¬ë””ë ‰ì…˜(>, >>, 2>&1)ì„ í™œìš©í•˜ì—¬ í‘œì¤€ ì¶œë ¥ê³¼ ì—ëŸ¬ ë¡œê·¸ë¥¼ íŠ¹ì • íŒŒì¼ë¡œ ì €ì¥

```bash
* * * * * /path/to/your/script.sh >> /path/to/logfile.log 2>&1
```

|ê¸°í˜¸ | ì˜ë¯¸|
|:---:|:-----:|
|>> | ê¸°ì¡´ ë¡œê·¸ íŒŒì¼ì— ì¶”ê°€ (append)|
|> | ê¸°ì¡´ ë¡œê·¸ íŒŒì¼ì„ ë®ì–´ì“°ê¸° (overwrite)|
|2>&1 | í‘œì¤€ ì—ëŸ¬(stderr)ë¥¼ í‘œì¤€ ì¶œë ¥(stdout)ìœ¼ë¡œ í•¨ê»˜ ë¦¬ë””ë ‰ì…˜|

---

## ğŸ“‚ ì‹¤ì œ ë¡œê·¸ ì˜ˆì‹œ (`update_20250413_195501.log`)

```text
===== ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘: Sun 13 Apr 2025 07:55:01 PM KST =====
ì¶”ê°€í•  ë°ì´í„° ìˆ˜ 48400
Total records in CSV: 48,400

Fetching existing records for duplicate check...
Found 7,737,608 existing records

Found 1,147 duplicate records
Unique records to insert: 47,253

Inserting unique records...

  0%|          | 0/47253 [00:00<?, ?it/s]
 21%|â–ˆâ–ˆ        | 10000/47253 [00:02<00:09, 3751.53it/s]
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20000/47253 [00:05<00:07, 3583.72it/s]
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 30000/47253 [00:08<00:04, 3595.00it/s]
 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 40000/47253 [00:10<00:01, 3669.71it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 47253/47253 [00:12<00:00, 3706.79it/s]

Data loading completed successfully!

Backing up inserted data to parquet files...
ì½ì–´ë“¤ì¸ ë§ˆì§€ë§‰ íŒŒíŠ¸ íŒŒì¼: /home/your_user/project/data/parquet/qoo10_ranking_part8.parquet, í–‰ ìˆ˜: 734,516  
ì¤‘ë³µ ì œê±° í›„ í–‰ ìˆ˜: 781,769  
ì—…ë°ì´íŠ¸ëœ íŒŒì¼ ì €ì¥: /home/your_user/project/data/parquet/qoo10_ranking_part8.parquet (781,769 í–‰)

Final Database Statistics:
Total Records: 7,784,861
Date Range: 2024-10-29 to 2025-04-13
Unique Categories: 11

Backing up inserted data to another folder...
ë°ì´í„° ë°±ì—… ì™„ë£Œ
===== ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ: Sun 13 Apr 2025 07:55:54 PM KST =====
```

---

## âœ¨ ë§ˆë¬´ë¦¬í•˜ë©°

`crontab`ì„ ì´ìš©í•˜ë©´ ë°˜ë³µì ì¸ ìˆ˜ì‘ì—…ì„ ìë™í™”í•˜ì—¬ ì‘ì—… íš¨ìœ¨ì„ ê·¹ëŒ€í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
íŠ¹íˆ ë°ì´í„° í¬ë¡¤ë§, ë°±ì—…, ì •ë¦¬ ì‘ì—…ì²˜ëŸ¼ ì •ê¸°ì„±ì´ ìˆëŠ” ì—…ë¬´ì— ë§¤ìš° ì í•©í•©ë‹ˆë‹¤.

ìŠ¤í¬ë¦½íŠ¸ì™€ ë¡œê·¸ ì²´ê³„ë¥¼ í•¨ê»˜ êµ¬ì„±í•˜ë©´ **ì—ëŸ¬ ëŒ€ì‘**, **ìƒíƒœ ëª¨ë‹ˆí„°ë§**, **ë°ì´í„° ë¬´ê²°ì„± ê´€ë¦¬**ì—ë„ í° ë„ì›€ì´ ë©ë‹ˆë‹¤.  
ì—¬ëŸ¬ë¶„ë„ crontabì„ í™œìš©í•˜ì—¬ ìë™í™”ì˜ ì²« ê±¸ìŒì„ ì‹œì‘í•´ë³´ì‹œê¸¸ ì¶”ì²œë“œë¦½ë‹ˆë‹¤!


[jekyll-docs]: https://jekyllrb.com/docs/home
[jekyll-gh]:   https://github.com/jekyll/jekyll
[jekyll-talk]: https://talk.jekyllrb.com/